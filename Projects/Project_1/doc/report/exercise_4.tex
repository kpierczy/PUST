\chapter{Symulacja algorytmów PID oraz DMC}

\section{PID}

Regulator PID w wersji dyskretnej obliczany jest ze wzoru:
\begin{equation}
	u(k) = r_0 * e(k) + r_1 * e(k-1) + r_2 * e(k-2)
\end{equation}
Gdzie:
\begin{equation}
	r_0 = K * ( 1 + \frac{T_s}{2*T_i} + \frac{T_d}{T_s} )
\end{equation}
\begin{equation}
	r_1 = K * ( \frac{T_s}{2*T_i} - \frac{2*T_d}{T_s} - 1)
\end{equation}
\begin{equation}
	r_2 = K * \frac{T_d}{T_s}
\end{equation}
Przyjête oznaczenia to: \\

K - wzmocnienie \\

$T_i$ - czas zdwojenia \\

$T_d$ - czas wyprzedzenia \\

$T_s$ - okres próbkowania \\
Po obliczeniu sygna³u steruj¹cego sprawdzanie jest, czy zmiana sygna³u steruj¹cego zawarta jest w przedziale:

\begin{equation}
	- \Delta U^{max} \leqslant \Delta U(k) \leqslant \Delta U^{max}
\end{equation}
Je¿eli zmiana sygna³u $\Delta U$ wykracza poza przyjête ograniczenia, wartoœæ zmiany sygna³u przyjmuje wartoœæ przekroczonego ograniczenia.

\section{DMC}

Regulator DMC w wersji dyskretnej obliczany jest ze wzoru:
\begin{equation}
	\Delta u = K * (Y^{zad} - Y^0)
\end{equation}
Gdzie:
\begin{equation}
	K = (M^TM + \lambda I)^{-1}M^T
\end{equation}
\begin{equation}
	Y^0 = Y(k) + M^p + * \Delta U^p(k)
\end{equation}
	\begin{equation}
		\boldsymbol{M}=\left[
		\begin{array}
			{cccc}
			s_{1} & 0 & \ldots & 0\\
			s_{2} & s_{1} & \ldots & 0\\
			\vdots & \vdots & \ddots & \vdots\\
			s_{N} & s_{N-1} & \ldots &  s_{N} - N_u + 1
		\end{array}
	\right]
\end{equation}
	\begin{equation}
		\boldsymbol{M^p}=\left[
		\begin{array}
			{cccc}
			s_{2} - s_{1} & s_{3} - s_{2} & \ldots & s_{D} - s_{D-1}\\
			s_{3} - s_{1} & s_{4} - s_{2} & \ldots & s_{D+1} - s_{D-1}\\
			\vdots & \vdots & \ddots & \vdots\\
			s_{N+1} - s_{1} & s_{N+2} - s_{2} & \ldots &  s_{N+D-1} - s_{D-1}
		\end{array}
	\right]
\end{equation}

	\begin{equation}
		\boldsymbol{Y(k)}=\left[
		\begin{array}
			{c}
			y(k)  \\
			y(k)  \\
			\vdots \\
			y(k) 
		\end{array}
	\right]
\end{equation}
	\begin{equation}
		\boldsymbol{\Delta U^p(k)}=\left[
		\begin{array}
			{c}
			\Delta u(k-1) \\
			\Delta u(k-2) \\
			\vdots \\
			\Delta u(k - (D - 1))
		\end{array}
	\right]
\end{equation}
Procedura sprawdzenia ograniczeñ przebiega identycznie jak w regulatorze PID.
